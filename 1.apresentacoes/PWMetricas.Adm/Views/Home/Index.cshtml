@using System.Security.Claims;
@using PWMetricas.Aplicacao.Modelos
@using PWMetricas.Aplicacao.Modelos.Dashboard
@model DashboardViewModel


@{
	var userName = User.Identity.IsAuthenticated ? User.FindFirst(ClaimTypes.Name)?.Value : "Visitante";
	var userPerfil = User.Identity.IsAuthenticated ? User.FindFirst("Perfil")?.Value : "Sem Perfil";
}


@{
	ViewData["Title"] = "Página Inicial";
}


@section PageSpecificContainer {
	<div class="container-fluid d-flex flex-wrap justify-content-between align-items-center">
		<div class="left-select mb-2 mb-lg-0">
			<select asp-for="LojaId" name="LojaId" id="LojaId" class="form-select">
				<option value="">Selecione uma filial</option>
				@if (ViewBag.Lojas != null)
				{
					@foreach (var loja in ViewBag.Lojas)
					{
						<option value="@loja.Value">
							@loja.Text
						</option>
					}
				}
			</select>
		</div>
		<div class="right-search">
			<input type="text" id="searchField" class="form-control" placeholder="Pesquisar..." />
		</div>
	</div>
}


@if (userPerfil == "Administrador" || userPerfil == "Gerente")
{
	<partial name="_Administrador" model="Model" />
}
@if (userPerfil == "Vendedor")
{
	<partial name="_Vendedor" model="Model" />
}


@section Scripts {
	<!-- Scripts para validação do lado do cliente -->
	<partial name="_ValidationScriptsPartial" />
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	@if (userPerfil == "Administrador" || userPerfil == "Gerente")
	{
		<script src="/js/dashboard/graficos.js"></script>
	}
	else
	{
		<script src="/js/dashboard/vendedor.js"></script>
	}

}